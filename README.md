# Annealing

Изначальная постановки задачи на Kaggle:

https://www.kaggle.com/c/santa-2021/overview

Можно заметить, что задача, по сути является очень частным случаем [MVRP](https://en.wikipedia.org/wiki/Vehicle_routing_problem). В этом проекте реализован алгоритм, который ищет решение именно этой обобщенной задачи 

**Постановка задачи:**

Дан взвешенный ориентированный граф и число r. Необходимо посетить каждую вершину хотя бы в одном из r маршрутов, минимизировав длину длиннейшего из маршрутов. В более общей формулировке минимизируется некоторый штраф (например, c1 * суммарная длина всех маршрутов + c2 * длина самого длинного маршрута)

**Описание алгоритма:**

Решение задачи основано на комбинации алгоритма имитации отжига и генетического алгоритма:

- изначально генерируется случайное решение, скорее всего, очень далекое от оптимального
- далее на каждом шаге решение с некоторой вероятностью мутирует
- примеры мутациий: перенос точки из одного маршрута в другой, изменение порядка обхода двух точек внутри одного маршрута и т.д.
- мутация происходит всегда, если приводит к уменьшению штрафа
- мутация происходит с некоторой вероятностью <img src="https://latex.codecogs.com/gif.latex?p=e^{\frac{-\Delta_{penalty}}{t}"/> , если приводит к увеличению штрафа
- t в формуле выше - температура, она постепенно стремится к 0 в процессе работы алгоритма

В ходе работы алгоритма удачные мутации закрепляются и решение становится лучше (ниже приведен график изменения общего штрафа в процессе оптимизации)

![img3](https://i.ibb.co/kh5yc2X/penalty-convergence.png)

**Пример работы алгоритма для случая вершин, расположенных на плоскости и евклидовых расстояних между ними:**

Маршруты, сгенерированные в начале оптимизации:

![img1](https://i.ibb.co/YffRHg7/initial-routes.png)

Маршруты, полученные в конце работы алгоритма:

![img2](https://i.ibb.co/cQXWvWQ/final-routes.png)
